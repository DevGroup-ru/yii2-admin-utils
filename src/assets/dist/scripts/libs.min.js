!function(t){var e,o,i=t(window),n={},a=[],s=[],p=null,l="_open",d="_close",r=[],c=null,u=/(iPad|iPhone|iPod)/g.test(navigator.userAgent),f="a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, *[tabindex], *[contenteditable]",h={_init:function(e){var o=t(e),i=o.data("popupoptions");s[e.id]=!1,a[e.id]=0,o.data("popup-initialized")||(o.attr("data-popup-initialized","true"),h._initonce(e)),i.autoopen&&setTimeout(function(){h.show(e,0)},0)},_initonce:function(o){var i,n,a=t(o),s=t("body"),d=a.data("popupoptions");if(p=parseInt(s.css("margin-right"),10),c=void 0!==document.body.style.webkitTransition||void 0!==document.body.style.MozTransition||void 0!==document.body.style.msTransition||void 0!==document.body.style.OTransition||void 0!==document.body.style.transition,"tooltip"==d.type&&(d.background=!1,d.scrolllock=!1),d.backgroundactive&&(d.background=!1,d.blur=!1,d.scrolllock=!1),d.scrolllock){var r,f;"undefined"==typeof e&&(r=t('<div style="width:50px;height:50px;overflow:auto"><div/></div>').appendTo("body"),f=r.children(),e=f.innerWidth()-f.height(99).innerWidth(),r.remove())}if(a.attr("id")||a.attr("id","j-popup-"+parseInt(1e8*Math.random(),10)),a.addClass("popup_content"),s.prepend(o),a.wrap('<div id="'+o.id+'_wrapper" class="popup_wrapper" />'),i=t("#"+o.id+"_wrapper"),i.css({opacity:0,visibility:"hidden",position:"absolute"}),u&&i.css("cursor","pointer"),"overlay"==d.type&&i.css("overflow","auto"),a.css({opacity:0,visibility:"hidden",display:"inline-block"}),d.setzindex&&!d.autozindex&&i.css("z-index","100001"),d.outline||a.css("outline","none"),d.transition&&(a.css("transition",d.transition),i.css("transition",d.transition)),a.attr("aria-hidden",!0),d.background&&!t("#"+o.id+"_background").length){s.prepend('<div id="'+o.id+'_background" class="popup_background"></div>');var b=t("#"+o.id+"_background");b.css({opacity:0,visibility:"hidden",backgroundColor:d.color,position:"fixed",top:0,right:0,bottom:0,left:0}),d.setzindex&&!d.autozindex&&b.css("z-index","100000"),d.transition&&b.css("transition",d.transition)}"overlay"==d.type&&(a.css({textAlign:"left",position:"relative",verticalAlign:"middle"}),n={position:"fixed",width:"100%",height:"100%",top:0,left:0,textAlign:"center"},d.backgroundactive&&(n.position="relative",n.height="0",n.overflow="visible"),i.css(n),i.append('<div class="popup_align" />'),t(".popup_align").css({display:"inline-block",verticalAlign:"middle",height:"100%"})),a.attr("role","dialog");var v=d.openelement?d.openelement:"."+o.id+l;t(v).each(function(e,o){t(o).attr("data-popup-ordinal",e),o.id||t(o).attr("id","open_"+parseInt(1e8*Math.random(),10))}),a.attr("aria-labelledby")||a.attr("aria-label")||a.attr("aria-labelledby",t(v).attr("id")),"hover"==d.action?(d.keepfocus=!1,t(v).on("mouseenter",function(e){h.show(o,t(this).data("popup-ordinal"))}),t(v).on("mouseleave",function(t){h.hide(o)})):t(document).on("click",v,function(e){e.preventDefault();var i=t(this).data("popup-ordinal");setTimeout(function(){h.show(o,i)},0)}),d.closebutton&&h.addclosebutton(o),d.detach?a.hide().detach():i.hide()},show:function(n,l){var u=t(n);if(!u.data("popup-visible")){u.data("popup-initialized")||h._init(n),u.attr("data-popup-initialized","true");var f=t("body"),v=u.data("popupoptions"),g=t("#"+n.id+"_wrapper"),m=t("#"+n.id+"_background");if(b(n,l,v.beforeopen),s[n.id]=l,setTimeout(function(){r.push(n.id)},0),v.autozindex){for(var y=document.getElementsByTagName("*"),_=y.length,k=0,w=0;_>w;w++){var x=t(y[w]).css("z-index");"auto"!==x&&(x=parseInt(x,10),x>k&&(k=x))}a[n.id]=k,v.background&&a[n.id]>0&&t("#"+n.id+"_background").css({zIndex:a[n.id]+1}),a[n.id]>0&&g.css({zIndex:a[n.id]+2})}v.detach?(g.prepend(n),u.show()):g.show(),o=setTimeout(function(){g.css({visibility:"visible",opacity:1}),t("html").addClass("popup_visible").addClass("popup_visible_"+n.id),g.addClass("popup_wrapper_visible")},20),v.scrolllock&&(f.css("overflow","hidden"),f.height()>i.height()&&f.css("margin-right",p+e)),v.backgroundactive&&u.css({top:(i.height()-(u.get(0).offsetHeight+parseInt(u.css("margin-top"),10)+parseInt(u.css("margin-bottom"),10)))/2+"px"}),u.css({visibility:"visible",opacity:1}),v.background&&(m.css({visibility:"visible",opacity:v.opacity}),setTimeout(function(){m.css({opacity:v.opacity})},0)),u.data("popup-visible",!0),h.reposition(n,l),u.data("focusedelementbeforepopup",document.activeElement),v.keepfocus&&(u.attr("tabindex",-1),setTimeout(function(){"closebutton"===v.focuselement?t("#"+n.id+" ."+n.id+d+":first").focus():v.focuselement?t(v.focuselement).focus():u.focus()},v.focusdelay)),t(v.pagecontainer).attr("aria-hidden",!0),u.attr("aria-hidden",!1),b(n,l,v.onopen),c?g.one("transitionend",function(){b(n,l,v.opentransitionend)}):b(n,l,v.opentransitionend)}},hide:function(e,i){var n=t.inArray(e.id,r);if(-1!==n){o&&clearTimeout(o);var a=t("body"),l=t(e),d=l.data("popupoptions"),u=t("#"+e.id+"_wrapper"),f=t("#"+e.id+"_background");l.data("popup-visible",!1),1===r.length?t("html").removeClass("popup_visible").removeClass("popup_visible_"+e.id):t("html").hasClass("popup_visible_"+e.id)&&t("html").removeClass("popup_visible_"+e.id),r.splice(n,1),u.hasClass("popup_wrapper_visible")&&u.removeClass("popup_wrapper_visible"),d.keepfocus&&!i&&setTimeout(function(){t(l.data("focusedelementbeforepopup")).is(":visible")&&l.data("focusedelementbeforepopup").focus()},0),u.css({visibility:"hidden",opacity:0}),l.css({visibility:"hidden",opacity:0}),d.background&&f.css({visibility:"hidden",opacity:0}),t(d.pagecontainer).attr("aria-hidden",!1),l.attr("aria-hidden",!0),b(e,s[e.id],d.onclose),c&&"0s"!==l.css("transition-duration")?l.one("transitionend",function(t){l.data("popup-visible")||(d.detach?l.hide().detach():u.hide()),d.scrolllock&&setTimeout(function(){a.css({overflow:"visible","margin-right":p})},10),b(e,s[e.id],d.closetransitionend)}):(d.detach?l.hide().detach():u.hide(),d.scrolllock&&setTimeout(function(){a.css({overflow:"visible","margin-right":p})},10),b(e,s[e.id],d.closetransitionend))}},toggle:function(e,o){t(e).data("popup-visible")?h.hide(e):setTimeout(function(){h.show(e,o)},0)},reposition:function(e,o){var n=t(e),a=n.data("popupoptions"),s=t("#"+e.id+"_wrapper");t("#"+e.id+"_background");if(o=o||0,"tooltip"==a.type){s.css({position:"absolute"});var p;p=a.tooltipanchor?t(a.tooltipanchor):a.openelement?t(a.openelement).filter('[data-popup-ordinal="'+o+'"]'):t("."+e.id+l+'[data-popup-ordinal="'+o+'"]');var d=p.offset();"right"==a.horizontal?s.css("left",d.left+p.outerWidth()+a.offsetleft):"leftedge"==a.horizontal?s.css("left",d.left+p.outerWidth()-p.outerWidth()+a.offsetleft):"left"==a.horizontal?s.css("right",i.width()-d.left-a.offsetleft):"rightedge"==a.horizontal?s.css("right",i.width()-d.left-p.outerWidth()-a.offsetleft):s.css("left",d.left+p.outerWidth()/2-n.outerWidth()/2-parseFloat(n.css("marginLeft"))+a.offsetleft),"bottom"==a.vertical?s.css("top",d.top+p.outerHeight()+a.offsettop):"bottomedge"==a.vertical?s.css("top",d.top+p.outerHeight()-n.outerHeight()+a.offsettop):"top"==a.vertical?s.css("bottom",i.height()-d.top-a.offsettop):"topedge"==a.vertical?s.css("bottom",i.height()-d.top-n.outerHeight()-a.offsettop):s.css("top",d.top+p.outerHeight()/2-n.outerHeight()/2-parseFloat(n.css("marginTop"))+a.offsettop)}else"overlay"==a.type&&(a.horizontal?s.css("text-align",a.horizontal):s.css("text-align","center"),a.vertical?n.css("vertical-align",a.vertical):n.css("vertical-align","middle"))},addclosebutton:function(e){var o;o=t(e).data("popupoptions").closebuttonmarkup?t(n.closebuttonmarkup).addClass(e.id+"_close"):'<button class="popup_close '+e.id+'_close" title="Close" aria-label="Close"><span aria-hidden="true">Ã—</span></button>',$el.data("popup-initialized")&&$el.append(o)}},b=function(e,o,i){var n=t(e).data("popupoptions"),a=n.openelement?n.openelement:"."+e.id+l,s=t(a+'[data-popup-ordinal="'+o+'"]');"function"==typeof i&&i.call(t(e),e,s)};t(document).on("keydown",function(e){if(r.length){var o=r[r.length-1],i=document.getElementById(o);t(i).data("popupoptions").escape&&27==e.keyCode&&h.hide(i)}}),t(document).on("click",function(e){if(r.length){var o=r[r.length-1],i=document.getElementById(o),n=t(i).data("popupoptions").closeelement?t(i).data("popupoptions").closeelement:"."+i.id+d;t(e.target).closest(n).length&&(e.preventDefault(),h.hide(i)),t(i).data("popupoptions").blur&&!t(e.target).closest("#"+o).length&&2!==e.which&&t(e.target).is(":visible")&&(t(i).data("popupoptions").background?(h.hide(i),e.preventDefault()):h.hide(i,!0))}}),t(document).on("keydown",function(e){if(r.length&&9==e.which){var o=r[r.length-1],i=document.getElementById(o),n=t(i).find("*"),a=n.filter(f).filter(":visible"),s=t(":focus"),p=a.length,l=a.index(s);0===p?(t(i).focus(),e.preventDefault()):e.shiftKey?0===l&&(a.get(p-1).focus(),e.preventDefault()):l==p-1&&(a.get(0).focus(),e.preventDefault())}}),t.fn.popup=function(e){return this.each(function(){var o=t(this);if("object"==typeof e){var i=t.extend({},t.fn.popup.defaults,e,o.data("popupoptions"));o.data("popupoptions",i),n=o.data("popupoptions"),h._init(this)}else"string"==typeof e?(o.data("popupoptions")||(o.data("popupoptions",t.fn.popup.defaults),n=o.data("popupoptions")),h[e].call(this,this)):(o.data("popupoptions")||(o.data("popupoptions",t.fn.popup.defaults),n=o.data("popupoptions")),h._init(this))})},t.fn.popup.defaults={type:"overlay",autoopen:!1,background:!0,backgroundactive:!1,color:"black",opacity:"0.5",horizontal:"center",vertical:"middle",offsettop:0,offsetleft:0,escape:!0,blur:!0,setzindex:!0,autozindex:!1,scrolllock:!1,closebutton:!1,closebuttonmarkup:null,keepfocus:!0,focuselement:null,focusdelay:50,outline:!1,pagecontainer:null,detach:!1,openelement:null,closeelement:null,transition:null,tooltipanchor:null,beforeopen:null,onclose:null,onopen:null,opentransitionend:null,closetransitionend:null}}(jQuery);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9zb3VyY2UvanF1ZXJ5LnBvcHVwb3ZlcmxheS5qcyJdLCJuYW1lcyI6WyIkIiwic2Nyb2xsYmFyd2lkdGgiLCJvcGVudGltZXIiLCIkd2luZG93Iiwid2luZG93Iiwib3B0aW9ucyIsInppbmRleHZhbHVlcyIsImxhc3RjbGlja2VkIiwiYm9keW1hcmdpbnJpZ2h0Iiwib3BlbnN1ZmZpeCIsImNsb3Nlc3VmZml4IiwidmlzaWJsZVBvcHVwc0FycmF5IiwidHJhbnNpdGlvbnN1cHBvcnQiLCJpT1MiLCJ0ZXN0IiwibmF2aWdhdG9yIiwidXNlckFnZW50IiwiZm9jdXNhYmxlRWxlbWVudHNTdHJpbmciLCJtZXRob2RzIiwiX2luaXQiLCJlbCIsIiRlbCIsImRhdGEiLCJpZCIsImF0dHIiLCJfaW5pdG9uY2UiLCJhdXRvb3BlbiIsInNldFRpbWVvdXQiLCJzaG93IiwiJHdyYXBwZXIiLCJjc3MiLCIkYm9keSIsInBhcnNlSW50IiwidW5kZWZpbmVkIiwiZG9jdW1lbnQiLCJib2R5Iiwic3R5bGUiLCJ3ZWJraXRUcmFuc2l0aW9uIiwiTW96VHJhbnNpdGlvbiIsIm1zVHJhbnNpdGlvbiIsIk9UcmFuc2l0aW9uIiwidHJhbnNpdGlvbiIsInR5cGUiLCJiYWNrZ3JvdW5kIiwic2Nyb2xsbG9jayIsImJhY2tncm91bmRhY3RpdmUiLCJibHVyIiwicGFyZW50IiwiY2hpbGQiLCJhcHBlbmRUbyIsImNoaWxkcmVuIiwiaW5uZXJXaWR0aCIsImhlaWdodCIsInJlbW92ZSIsIk1hdGgiLCJyYW5kb20iLCJhZGRDbGFzcyIsInByZXBlbmQiLCJ3cmFwIiwib3BhY2l0eSIsInZpc2liaWxpdHkiLCJwb3NpdGlvbiIsImRpc3BsYXkiLCJzZXR6aW5kZXgiLCJhdXRvemluZGV4Iiwib3V0bGluZSIsImxlbmd0aCIsIiRiYWNrZ3JvdW5kIiwiYmFja2dyb3VuZENvbG9yIiwiY29sb3IiLCJ0b3AiLCJyaWdodCIsImJvdHRvbSIsImxlZnQiLCJ0ZXh0QWxpZ24iLCJ2ZXJ0aWNhbEFsaWduIiwid2lkdGgiLCJvdmVyZmxvdyIsImFwcGVuZCIsIm9wZW5lbGVtZW50IiwiZWFjaCIsImkiLCJpdGVtIiwiYWN0aW9uIiwia2VlcGZvY3VzIiwib24iLCJldmVudCIsInRoaXMiLCJoaWRlIiwicHJldmVudERlZmF1bHQiLCJvcmQiLCJjbG9zZWJ1dHRvbiIsImFkZGNsb3NlYnV0dG9uIiwiZGV0YWNoIiwib3JkaW5hbCIsImNhbGxiYWNrIiwiYmVmb3Jlb3BlbiIsInB1c2giLCJlbGVtZW50cyIsImdldEVsZW1lbnRzQnlUYWdOYW1lIiwibGVuIiwibWF4emluZGV4IiwiZWxlbWVudHppbmRleCIsInpJbmRleCIsImdldCIsIm9mZnNldEhlaWdodCIsInJlcG9zaXRpb24iLCJhY3RpdmVFbGVtZW50IiwiZm9jdXNlbGVtZW50IiwiZm9jdXMiLCJmb2N1c2RlbGF5IiwicGFnZWNvbnRhaW5lciIsIm9ub3BlbiIsIm9uZSIsIm9wZW50cmFuc2l0aW9uZW5kIiwib3V0ZXJDbGljayIsInBvcHVwSWRJbmRleCIsImluQXJyYXkiLCJjbGVhclRpbWVvdXQiLCJyZW1vdmVDbGFzcyIsImhhc0NsYXNzIiwic3BsaWNlIiwiaXMiLCJvbmNsb3NlIiwiZSIsIm1hcmdpbi1yaWdodCIsImNsb3NldHJhbnNpdGlvbmVuZCIsInRvZ2dsZSIsIiR0b29sdGlwYW5jaG9yIiwidG9vbHRpcGFuY2hvciIsImZpbHRlciIsImxpbmtPZmZzZXQiLCJvZmZzZXQiLCJob3Jpem9udGFsIiwib3V0ZXJXaWR0aCIsIm9mZnNldGxlZnQiLCJwYXJzZUZsb2F0IiwidmVydGljYWwiLCJvdXRlckhlaWdodCIsIm9mZnNldHRvcCIsImdlbmVyaWNDbG9zZUJ1dHRvbiIsImNsb3NlYnV0dG9ubWFya3VwIiwiZnVuYyIsImVsZW1lbnRjbGlja2VkIiwiY2FsbCIsImVsZW1lbnRJZCIsImdldEVsZW1lbnRCeUlkIiwiZXNjYXBlIiwia2V5Q29kZSIsImNsb3NlQnV0dG9uIiwiY2xvc2VlbGVtZW50IiwidGFyZ2V0IiwiY2xvc2VzdCIsIndoaWNoIiwicG9wdXBJdGVtcyIsImZpbmQiLCJmb2N1c2FibGVJdGVtcyIsImZvY3VzZWRJdGVtIiwibnVtYmVyT2ZGb2N1c2FibGVJdGVtcyIsImZvY3VzZWRJdGVtSW5kZXgiLCJpbmRleCIsInNoaWZ0S2V5IiwiZm4iLCJwb3B1cCIsImN1c3RvbW9wdGlvbnMiLCJvcHQiLCJleHRlbmQiLCJkZWZhdWx0cyIsImpRdWVyeSJdLCJtYXBwaW5ncyI6IkNBT0EsU0FBQUEsR0FFQSxHQUlBQyxHQU1BQyxFQVZBQyxFQUFBSCxFQUFBSSxRQUNBQyxLQUNBQyxLQUNBQyxLQUVBQyxFQUFBLEtBQ0FDLEVBQUEsUUFDQUMsRUFBQSxTQUNBQyxLQUNBQyxFQUFBLEtBRUFDLEVBQUEsc0JBQUFDLEtBQUFDLFVBQUFDLFdBQ0FDLEVBQUEsK0tBRUFDLEdBRUFDLE1BQUEsU0FBQUMsR0FDQSxHQUFBQyxHQUFBckIsRUFBQW9CLEdBQ0FmLEVBQUFnQixFQUFBQyxLQUFBLGVBQ0FmLEdBQUFhLEVBQUFHLEtBQUEsRUFDQWpCLEVBQUFjLEVBQUFHLElBQUEsRUFFQUYsRUFBQUMsS0FBQSx1QkFDQUQsRUFBQUcsS0FBQSx5QkFBQSxRQUNBTixFQUFBTyxVQUFBTCxJQUdBZixFQUFBcUIsVUFDQUMsV0FBQSxXQUNBVCxFQUFBVSxLQUFBUixFQUFBLElBQ0EsSUFJQUssVUFBQSxTQUFBTCxHQUNBLEdBRUFTLEdBRUFDLEVBSkFULEVBQUFyQixFQUFBb0IsR0FDQVcsRUFBQS9CLEVBQUEsUUFFQUssRUFBQWdCLEVBQUFDLEtBQUEsZUFxQkEsSUFsQkFkLEVBQUF3QixTQUFBRCxFQUFBRCxJQUFBLGdCQUFBLElBQ0FsQixFQUFBcUIsU0FBQUMsU0FBQUMsS0FBQUMsTUFBQUMsa0JBQ0FKLFNBQUFDLFNBQUFDLEtBQUFDLE1BQUFFLGVBQ0FMLFNBQUFDLFNBQUFDLEtBQUFDLE1BQUFHLGNBQ0FOLFNBQUFDLFNBQUFDLEtBQUFDLE1BQUFJLGFBQ0FQLFNBQUFDLFNBQUFDLEtBQUFDLE1BQUFLLFdBRUEsV0FBQXBD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TUFBQSxFQUNBaUIsV0FBQSxFQUNBQyxZQUFBLEVBQ0FwQixZQUFBLEVBQ0ErQyxhQUFBLEVBQ0FrRCxrQkFBQSxLQUNBekQsV0FBQSxFQUNBd0IsYUFBQSxLQUNBRSxXQUFBLEdBQ0E3QyxTQUFBLEVBQ0E4QyxjQUFBLEtBQ0FsQixRQUFBLEVBQ0FkLFlBQUEsS0FDQXVFLGFBQUEsS0FDQTdHLFdBQUEsS0FDQXdGLGNBQUEsS0FDQWpDLFdBQUEsS0FDQTJCLFFBQUEsS0FDQVgsT0FBQSxLQUNBRSxrQkFBQSxLQUNBWSxtQkFBQSxPQUdBMEMiLCJmaWxlIjoibGlicy5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKiFcclxuICogalF1ZXJ5IFBvcHVwIE92ZXJsYXlcclxuICpcclxuICogQHZlcnNpb24gMS43LjEwXHJcbiAqIEByZXF1aXJlcyBqUXVlcnkgdjEuNy4xK1xyXG4gKiBAbGluayBodHRwOi8vdmFzdC1lbmdpbmVlcmluZy5naXRodWIuY29tL2pxdWVyeS1wb3B1cC1vdmVybGF5L1xyXG4gKi9cclxuOyhmdW5jdGlvbiAoJCkge1xyXG5cclxuICAgIHZhciAkd2luZG93ID0gJCh3aW5kb3cpO1xyXG4gICAgdmFyIG9wdGlvbnMgPSB7fTtcclxuICAgIHZhciB6aW5kZXh2YWx1ZXMgPSBbXTtcclxuICAgIHZhciBsYXN0Y2xpY2tlZCA9IFtdO1xyXG4gICAgdmFyIHNjcm9sbGJhcndpZHRoO1xyXG4gICAgdmFyIGJvZHltYXJnaW5yaWdodCA9IG51bGw7XHJcbiAgICB2YXIgb3BlbnN1ZmZpeCA9ICdfb3Blbic7XHJcbiAgICB2YXIgY2xvc2VzdWZmaXggPSAnX2Nsb3NlJztcclxuICAgIHZhciB2aXNpYmxlUG9wdXBzQXJyYXkgPSBbXTtcclxuICAgIHZhciB0cmFuc2l0aW9uc3VwcG9ydCA9IG51bGw7XHJcbiAgICB2YXIgb3BlbnRpbWVyO1xyXG4gICAgdmFyIGlPUyA9IC8oaVBhZHxpUGhvbmV8aVBvZCkvZy50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpO1xyXG4gICAgdmFyIGZvY3VzYWJsZUVsZW1lbnRzU3RyaW5nID0gXCJhW2hyZWZdLCBhcmVhW2hyZWZdLCBpbnB1dDpub3QoW2Rpc2FibGVkXSksIHNlbGVjdDpub3QoW2Rpc2FibGVkXSksIHRleHRhcmVhOm5vdChbZGlzYWJsZWRdKSwgYnV0dG9uOm5vdChbZGlzYWJsZWRdKSwgaWZyYW1lLCBvYmplY3QsIGVtYmVkLCAqW3RhYmluZGV4XSwgKltjb250ZW50ZWRpdGFibGVdXCI7XHJcblxyXG4gICAgdmFyIG1ldGhvZHMgPSB7XHJcblxyXG4gICAgICAgIF9pbml0OiBmdW5jdGlvbiAoZWwpIHtcclxuICAgICAgICAgICAgdmFyICRlbCA9ICQoZWwpO1xyXG4gICAgICAgICAgICB2YXIgb3B0aW9ucyA9ICRlbC5kYXRhKCdwb3B1cG9wdGlvbnMnKTtcclxuICAgICAgICAgICAgbGFzdGNsaWNrZWRbZWwuaWRdID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHppbmRleHZhbHVlc1tlbC5pZF0gPSAwO1xyXG5cclxuICAgICAgICAgICAgaWYgKCEkZWwuZGF0YSgncG9wdXAtaW5pdGlhbGl6ZWQnKSkge1xyXG4gICAgICAgICAgICAgICAgJGVsLmF0dHIoJ2RhdGEtcG9wdXAtaW5pdGlhbGl6ZWQnLCAndHJ1ZScpO1xyXG4gICAgICAgICAgICAgICAgbWV0aG9kcy5faW5pdG9uY2UoZWwpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAob3B0aW9ucy5hdXRvb3Blbikge1xyXG4gICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICBtZXRob2RzLnNob3coZWwsIDApO1xyXG4gICAgICAgICAgICAgICAgfSwgMCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBfaW5pdG9uY2U6IGZ1bmN0aW9uIChlbCkge1xyXG4gICAgICAgICAgICB2YXIgJGVsID0gJChlbCk7XHJcbiAgICAgICAgICAgIHZhciAkYm9keSA9ICQoJ2JvZHknKTtcclxuICAgICAgICAgICAgdmFyICR3cmFwcGVyO1xyXG4gICAgICAgICAgICB2YXIgb3B0aW9ucyA9ICRlbC5kYXRhKCdwb3B1cG9wdGlvbnMnKTtcclxuICAgICAgICAgICAgdmFyIGNzcztcclxuXHJcbiAgICAgICAgICAgIGJvZHltYXJnaW5yaWdodCA9IHBhcnNlSW50KCRib2R5LmNzcygnbWFyZ2luLXJpZ2h0JyksIDEwKTtcclxuICAgICAgICAgICAgdHJhbnNpdGlvbnN1cHBvcnQgPSBkb2N1bWVudC5ib2R5LnN0eWxlLndlYmtpdFRyYW5zaXRpb24gIT09IHVuZGVmaW5lZCB8fFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuc3R5bGUuTW96VHJhbnNpdGlvbiAhPT0gdW5kZWZpbmVkIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5zdHlsZS5tc1RyYW5zaXRpb24gIT09IHVuZGVmaW5lZCB8fFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuc3R5bGUuT1RyYW5zaXRpb24gIT09IHVuZGVmaW5lZCB8fFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuc3R5bGUudHJhbnNpdGlvbiAhPT0gdW5kZWZpbmVkO1xyXG5cclxuICAgICAgICAgICAgaWYgKG9wdGlvbnMudHlwZSA9PSAndG9vbHRpcCcpIHtcclxuICAgICAgICAgICAgICAgIG9wdGlvbnMuYmFja2dyb3VuZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgb3B0aW9ucy5zY3JvbGxsb2NrID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmIChvcHRpb25zLmJhY2tncm91bmRhY3RpdmUpIHtcclxuICAgICAgICAgICAgICAgIG9wdGlvbnMuYmFja2dyb3VuZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgb3B0aW9ucy5ibHVyID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICBvcHRpb25zLnNjcm9sbGxvY2sgPSBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKG9wdGlvbnMuc2Nyb2xsbG9jaykge1xyXG4gICAgICAgICAgICAgICAgLy8gQ2FsY3VsYXRlIHRoZSBicm93c2VyJ3Mgc2Nyb2xsYmFyIHdpZHRoIGR5bmFtaWNhbGx5XHJcbiAgICAgICAgICAgICAgICB2YXIgcGFyZW50O1xyXG4gICAgICAgICAgICAgICAgdmFyIGNoaWxkO1xyXG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBzY3JvbGxiYXJ3aWR0aCA9PT0gJ3VuZGVmaW5lZCcpIHtcclxuICAgICAgICAgICAgICAgICAgICBwYXJlbnQgPSAkKCc8ZGl2IHN0eWxlPVwid2lkdGg6NTBweDtoZWlnaHQ6NTBweDtvdmVyZmxvdzphdXRvXCI+PGRpdi8+PC9kaXY+JykuYXBwZW5kVG8oJ2JvZHknKTtcclxuICAgICAgICAgICAgICAgICAgICBjaGlsZCA9IHBhcmVudC5jaGlsZHJlbigpO1xyXG4gICAgICAgICAgICAgICAgICAgIHNjcm9sbGJhcndpZHRoID0gY2hpbGQuaW5uZXJXaWR0aCgpIC0gY2hpbGQuaGVpZ2h0KDk5KS5pbm5lcldpZHRoKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgcGFyZW50LnJlbW92ZSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoISRlbC5hdHRyKCdpZCcpKSB7XHJcbiAgICAgICAgICAgICAgICAkZWwuYXR0cignaWQnLCAnai1wb3B1cC0nICsgcGFyc2VJbnQoKE1hdGgucmFuZG9tKCkgKiAxMDAwMDAwMDApLCAxMCkpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAkZWwuYWRkQ2xhc3MoJ3BvcHVwX2NvbnRlbnQnKTtcclxuXHJcbiAgICAgICAgICAgICRib2R5LnByZXBlbmQoZWwpO1xyXG5cclxuICAgICAgICAgICAgJGVsLndyYXAoJzxkaXYgaWQ9XCInICsgZWwuaWQgKyAnX3dyYXBwZXJcIiBjbGFzcz1cInBvcHVwX3dyYXBwZXJcIiAvPicpO1xyXG5cclxuICAgICAgICAgICAgJHdyYXBwZXIgPSAkKCcjJyArIGVsLmlkICsgJ193cmFwcGVyJyk7XHJcblxyXG4gICAgICAgICAgICAkd3JhcHBlci5jc3Moe1xyXG4gICAgICAgICAgICAgICAgb3BhY2l0eTogMCxcclxuICAgICAgICAgICAgICAgIHZpc2liaWxpdHk6ICdoaWRkZW4nLFxyXG4gICAgICAgICAgICAgICAgcG9zaXRpb246ICdhYnNvbHV0ZSdcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyBNYWtlIGRpdiBjbGlja2FibGUgaW4gaU9TXHJcbiAgICAgICAgICAgIGlmIChpT1MpIHtcclxuICAgICAgICAgICAgICAgICR3cmFwcGVyLmNzcygnY3Vyc29yJywgJ3BvaW50ZXInKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKG9wdGlvbnMudHlwZSA9PSAnb3ZlcmxheScpIHtcclxuICAgICAgICAgICAgICAgICR3cmFwcGVyLmNzcygnb3ZlcmZsb3cnLCdhdXRvJyk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICRlbC5jc3Moe1xyXG4gICAgICAgICAgICAgICAgb3BhY2l0eTogMCxcclxuICAgICAgICAgICAgICAgIHZpc2liaWxpdHk6ICdoaWRkZW4nLFxyXG4gICAgICAgICAgICAgICAgZGlzcGxheTogJ2lubGluZS1ibG9jaydcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBpZiAob3B0aW9ucy5zZXR6aW5kZXggJiYgIW9wdGlvbnMuYXV0b3ppbmRleCkge1xyXG4gICAgICAgICAgICAgICAgJHdyYXBwZXIuY3NzKCd6LWluZGV4JywgJzEwMDAwMScpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoIW9wdGlvbnMub3V0bGluZSkge1xyXG4gICAgICAgICAgICAgICAgJGVsLmNzcygnb3V0bGluZScsICdub25lJyk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmIChvcHRpb25zLnRyYW5zaXRpb24pIHtcclxuICAgICAgICAgICAgICAgICRlbC5jc3MoJ3RyYW5zaXRpb24nLCBvcHRpb25zLnRyYW5zaXRpb24pO1xyXG4gICAgICAgICAgICAgICAgJHdyYXBwZXIuY3NzKCd0cmFuc2l0aW9uJywgb3B0aW9ucy50cmFuc2l0aW9uKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gSGlkZSBwb3B1cCBjb250ZW50IGZyb20gc2NyZWVuIHJlYWRlcnMgaW5pdGlhbGx5XHJcbiAgICAgICAgICAgICRlbC5hdHRyKCdhcmlhLWhpZGRlbicsIHRydWUpO1xyXG5cclxuICAgICAgICAgICAgaWYgKChvcHRpb25zLmJhY2tncm91bmQpICYmICghJCgnIycgKyBlbC5pZCArICdfYmFja2dyb3VuZCcpLmxlbmd0aCkpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAkYm9keS5wcmVwZW5kKCc8ZGl2IGlkPVwiJyArIGVsLmlkICsgJ19iYWNrZ3JvdW5kXCIgY2xhc3M9XCJwb3B1cF9iYWNrZ3JvdW5kXCI+PC9kaXY+Jyk7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyICRiYWNrZ3JvdW5kID0gJCgnIycgKyBlbC5pZCArICdfYmFja2dyb3VuZCcpO1xyXG5cclxuICAgICAgICAgICAgICAgICRiYWNrZ3JvdW5kLmNzcyh7XHJcbiAgICAgICAgICAgICAgICAgICAgb3BhY2l0eTogMCxcclxuICAgICAgICAgICAgICAgICAgICB2aXNpYmlsaXR5OiAnaGlkZGVuJyxcclxuICAgICAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6IG9wdGlvbnMuY29sb3IsXHJcbiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246ICdmaXhlZCcsXHJcbiAgICAgICAgICAgICAgICAgICAgdG9wOiAwLFxyXG4gICAgICAgICAgICAgICAgICAgIHJpZ2h0OiAwLFxyXG4gICAgICAgICAgICAgICAgICAgIGJvdHRvbTogMCxcclxuICAgICAgICAgICAgICAgICAgICBsZWZ0OiAwXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAob3B0aW9ucy5zZXR6aW5kZXggJiYgIW9wdGlvbnMuYXV0b3ppbmRleCkge1xyXG4gICAgICAgICAgICAgICAgICAgICRiYWNrZ3JvdW5kLmNzcygnei1pbmRleCcsICcxMDAwMDAnKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBpZiAob3B0aW9ucy50cmFuc2l0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJGJhY2tncm91bmQuY3NzKCd0cmFuc2l0aW9uJywgb3B0aW9ucy50cmFuc2l0aW9uKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKG9wdGlvbnMudHlwZSA9PSAnb3ZlcmxheScpIHtcclxuICAgICAgICAgICAgICAgICRlbC5jc3Moe1xyXG4gICAgICAgICAgICAgICAgICAgIHRleHRBbGlnbjogJ2xlZnQnLFxyXG4gICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAncmVsYXRpdmUnLFxyXG4gICAgICAgICAgICAgICAgICAgIHZlcnRpY2FsQWxpZ246ICdtaWRkbGUnXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICBjc3MgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246ICdmaXhlZCcsXHJcbiAgICAgICAgICAgICAgICAgICAgd2lkdGg6ICcxMDAlJyxcclxuICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6ICcxMDAlJyxcclxuICAgICAgICAgICAgICAgICAgICB0b3A6IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgbGVmdDogMCxcclxuICAgICAgICAgICAgICAgICAgICB0ZXh0QWxpZ246ICdjZW50ZXInXHJcbiAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgIGlmKG9wdGlvbnMuYmFja2dyb3VuZGFjdGl2ZSl7XHJcbiAgICAgICAgICAgICAgICAgICAgY3NzLnBvc2l0aW9uID0gJ3JlbGF0aXZlJztcclxuICAgICAgICAgICAgICAgICAgICBjc3MuaGVpZ2h0ID0gJzAnO1xyXG4gICAgICAgICAgICAgICAgICAgIGNzcy5vdmVyZmxvdyA9ICd2aXNpYmxlJztcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAkd3JhcHBlci5jc3MoY3NzKTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBDU1MgdmVydGljYWwgYWxpZ24gaGVscGVyXHJcbiAgICAgICAgICAgICAgICAkd3JhcHBlci5hcHBlbmQoJzxkaXYgY2xhc3M9XCJwb3B1cF9hbGlnblwiIC8+Jyk7XHJcblxyXG4gICAgICAgICAgICAgICAgJCgnLnBvcHVwX2FsaWduJykuY3NzKHtcclxuICAgICAgICAgICAgICAgICAgICBkaXNwbGF5OiAnaW5saW5lLWJsb2NrJyxcclxuICAgICAgICAgICAgICAgICAgICB2ZXJ0aWNhbEFsaWduOiAnbWlkZGxlJyxcclxuICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6ICcxMDAlJ1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIEFkZCBXQUkgQVJJQSByb2xlIHRvIGFubm91bmNlIGRpYWxvZyB0byBzY3JlZW4gcmVhZGVyc1xyXG4gICAgICAgICAgICAkZWwuYXR0cigncm9sZScsICdkaWFsb2cnKTtcclxuXHJcbiAgICAgICAgICAgIHZhciBvcGVuZWxlbWVudCA9ICAob3B0aW9ucy5vcGVuZWxlbWVudCkgPyBvcHRpb25zLm9wZW5lbGVtZW50IDogKCcuJyArIGVsLmlkICsgb3BlbnN1ZmZpeCk7XHJcblxyXG4gICAgICAgICAgICAkKG9wZW5lbGVtZW50KS5lYWNoKGZ1bmN0aW9uIChpLCBpdGVtKSB7XHJcbiAgICAgICAgICAgICAgICAkKGl0ZW0pLmF0dHIoJ2RhdGEtcG9wdXAtb3JkaW5hbCcsIGkpO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmICghaXRlbS5pZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICQoaXRlbSkuYXR0cignaWQnLCAnb3Blbl8nICsgcGFyc2VJbnQoKE1hdGgucmFuZG9tKCkgKiAxMDAwMDAwMDApLCAxMCkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vIFNldCBhcmlhLWxhYmVsbGVkYnkgKGlmIGFyaWEtbGFiZWwgb3IgYXJpYS1sYWJlbGxlZGJ5IGlzIG5vdCBzZXQgaW4gaHRtbClcclxuICAgICAgICAgICAgaWYgKCEoJGVsLmF0dHIoJ2FyaWEtbGFiZWxsZWRieScpIHx8ICRlbC5hdHRyKCdhcmlhLWxhYmVsJykpKSB7XHJcbiAgICAgICAgICAgICAgICAkZWwuYXR0cignYXJpYS1sYWJlbGxlZGJ5JywgJChvcGVuZWxlbWVudCkuYXR0cignaWQnKSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIFNob3cgYW5kIGhpZGUgdG9vbHRpcHMgb24gaG92ZXJcclxuICAgICAgICAgICAgaWYob3B0aW9ucy5hY3Rpb24gPT0gJ2hvdmVyJyl7XHJcbiAgICAgICAgICAgICAgICBvcHRpb25zLmtlZXBmb2N1cyA9IGZhbHNlO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIEhhbmRsZXI6IG1vdXNlZW50ZXIsIGZvY3VzaW5cclxuICAgICAgICAgICAgICAgICQob3BlbmVsZW1lbnQpLm9uKCdtb3VzZWVudGVyJywgZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kcy5zaG93KGVsLCAkKHRoaXMpLmRhdGEoJ3BvcHVwLW9yZGluYWwnKSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBIYW5kbGVyOiBtb3VzZWxlYXZlLCBmb2N1c291dFxyXG4gICAgICAgICAgICAgICAgJChvcGVuZWxlbWVudCkub24oJ21vdXNlbGVhdmUnLCBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICBtZXRob2RzLmhpZGUoZWwpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIEhhbmRsZXI6IFNob3cgcG9wdXAgd2hlbiBjbGlja2VkIG9uIGBvcGVuYCBlbGVtZW50XHJcbiAgICAgICAgICAgICAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCBvcGVuZWxlbWVudCwgZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG9yZCA9ICQodGhpcykuZGF0YSgncG9wdXAtb3JkaW5hbCcpO1xyXG4gICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7IC8vIHNldFRpbWVvdXQgaXMgdG8gYWxsb3cgYGNsb3NlYCBtZXRob2QgdG8gZmluaXNoIChmb3IgaXNzdWVzIHdpdGggbXVsdGlwbGUgdG9vbHRpcHMpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZHMuc2hvdyhlbCwgb3JkKTtcclxuICAgICAgICAgICAgICAgICAgICB9LCAwKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAob3B0aW9ucy5jbG9zZWJ1dHRvbikge1xyXG4gICAgICAgICAgICAgICAgbWV0aG9kcy5hZGRjbG9zZWJ1dHRvbihlbCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmIChvcHRpb25zLmRldGFjaCkge1xyXG4gICAgICAgICAgICAgICAgJGVsLmhpZGUoKS5kZXRhY2goKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICR3cmFwcGVyLmhpZGUoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFNob3cgbWV0aG9kXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcGFyYW0ge29iamVjdH0gZWwgLSBwb3B1cCBpbnN0YW5jZSBET00gbm9kZVxyXG4gICAgICAgICAqIEBwYXJhbSB7bnVtYmVyfSBvcmRpbmFsIC0gb3JkZXIgbnVtYmVyIG9mIGFuIGBvcGVuYCBlbGVtZW50XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgc2hvdzogZnVuY3Rpb24gKGVsLCBvcmRpbmFsKSB7XHJcbiAgICAgICAgICAgIHZhciAkZWwgPSAkKGVsKTtcclxuXHJcbiAgICAgICAgICAgIGlmICgkZWwuZGF0YSgncG9wdXAtdmlzaWJsZScpKSByZXR1cm47XHJcblxyXG4gICAgICAgICAgICAvLyBJbml0aWFsaXplIGlmIG5vdCBpbml0aWFsaXplZC4gUmVxdWlyZWQgZm9yOiAkKCcjcG9wdXAnKS5wb3B1cCgnc2hvdycpXHJcbiAgICAgICAgICAgIGlmICghJGVsLmRhdGEoJ3BvcHVwLWluaXRpYWxpemVkJykpIHtcclxuICAgICAgICAgICAgICAgIG1ldGhvZHMuX2luaXQoZWwpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICRlbC5hdHRyKCdkYXRhLXBvcHVwLWluaXRpYWxpemVkJywgJ3RydWUnKTtcclxuXHJcbiAgICAgICAgICAgIHZhciAkYm9keSA9ICQoJ2JvZHknKTtcclxuICAgICAgICAgICAgdmFyIG9wdGlvbnMgPSAkZWwuZGF0YSgncG9wdXBvcHRpb25zJyk7XHJcbiAgICAgICAgICAgIHZhciAkd3JhcHBlciA9ICQoJyMnICsgZWwuaWQgKyAnX3dyYXBwZXInKTtcclxuICAgICAgICAgICAgdmFyICRiYWNrZ3JvdW5kID0gJCgnIycgKyBlbC5pZCArICdfYmFja2dyb3VuZCcpO1xyXG5cclxuICAgICAgICAgICAgLy8gYGJlZm9yZW9wZW5gIGNhbGxiYWNrIGV2ZW50XHJcbiAgICAgICAgICAgIGNhbGxiYWNrKGVsLCBvcmRpbmFsLCBvcHRpb25zLmJlZm9yZW9wZW4pO1xyXG5cclxuICAgICAgICAgICAgLy8gUmVtZW1iZXIgbGFzdCBjbGlja2VkIHBsYWNlXHJcbiAgICAgICAgICAgIGxhc3RjbGlja2VkW2VsLmlkXSA9IG9yZGluYWw7XHJcblxyXG4gICAgICAgICAgICAvLyBBZGQgcG9wdXAgaWQgdG8gdmlzaWJsZVBvcHVwc0FycmF5XHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICB2aXNpYmxlUG9wdXBzQXJyYXkucHVzaChlbC5pZCk7XHJcbiAgICAgICAgICAgIH0sIDApO1xyXG5cclxuICAgICAgICAgICAgLy8gQ2FsY3VsYXRpbmcgbWF4aW11bSB6LWluZGV4XHJcbiAgICAgICAgICAgIGlmIChvcHRpb25zLmF1dG96aW5kZXgpIHtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgZWxlbWVudHMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnKicpO1xyXG4gICAgICAgICAgICAgICAgdmFyIGxlbiA9IGVsZW1lbnRzLmxlbmd0aDtcclxuICAgICAgICAgICAgICAgIHZhciBtYXh6aW5kZXggPSAwO1xyXG5cclxuICAgICAgICAgICAgICAgIGZvcih2YXIgaT0wOyBpPGxlbjsgaSsrKXtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGVsZW1lbnR6aW5kZXggPSAkKGVsZW1lbnRzW2ldKS5jc3MoJ3otaW5kZXgnKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYoZWxlbWVudHppbmRleCAhPT0gJ2F1dG8nKXtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50emluZGV4ID0gcGFyc2VJbnQoZWxlbWVudHppbmRleCwgMTApO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgIGlmKG1heHppbmRleCA8IGVsZW1lbnR6aW5kZXgpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXh6aW5kZXggPSBlbGVtZW50emluZGV4O1xyXG4gICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICB6aW5kZXh2YWx1ZXNbZWwuaWRdID0gbWF4emluZGV4O1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIEFkZCB6LWluZGV4IHRvIHRoZSBiYWNrZ3JvdW5kXHJcbiAgICAgICAgICAgICAgICBpZiAob3B0aW9ucy5iYWNrZ3JvdW5kKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHppbmRleHZhbHVlc1tlbC5pZF0gPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICQoJyMnICsgZWwuaWQgKyAnX2JhY2tncm91bmQnKS5jc3Moe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgekluZGV4OiAoemluZGV4dmFsdWVzW2VsLmlkXSArIDEpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAvLyBBZGQgei1pbmRleCB0byB0aGUgd3JhcHBlclxyXG4gICAgICAgICAgICAgICAgaWYgKHppbmRleHZhbHVlc1tlbC5pZF0gPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHdyYXBwZXIuY3NzKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgekluZGV4OiAoemluZGV4dmFsdWVzW2VsLmlkXSArIDIpXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmIChvcHRpb25zLmRldGFjaCkge1xyXG4gICAgICAgICAgICAgICAgJHdyYXBwZXIucHJlcGVuZChlbCk7XHJcbiAgICAgICAgICAgICAgICAkZWwuc2hvdygpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgJHdyYXBwZXIuc2hvdygpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBvcGVudGltZXIgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgJHdyYXBwZXIuY3NzKHtcclxuICAgICAgICAgICAgICAgICAgICB2aXNpYmlsaXR5OiAndmlzaWJsZScsXHJcbiAgICAgICAgICAgICAgICAgICAgb3BhY2l0eTogMVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgJCgnaHRtbCcpLmFkZENsYXNzKCdwb3B1cF92aXNpYmxlJykuYWRkQ2xhc3MoJ3BvcHVwX3Zpc2libGVfJyArIGVsLmlkKTtcclxuICAgICAgICAgICAgICAgICR3cmFwcGVyLmFkZENsYXNzKCdwb3B1cF93cmFwcGVyX3Zpc2libGUnKTtcclxuICAgICAgICAgICAgfSwgMjApOyAvLyAyMG1zIHJlcXVpcmVkIGZvciBvcGVuaW5nIGFuaW1hdGlvbiB0byBvY2N1ciBpbiBGRlxyXG5cclxuICAgICAgICAgICAgLy8gRGlzYWJsZSBiYWNrZ3JvdW5kIGxheWVyIHNjcm9sbGluZyB3aGVuIHBvcHVwIGlzIG9wZW5lZFxyXG4gICAgICAgICAgICBpZiAob3B0aW9ucy5zY3JvbGxsb2NrKSB7XHJcbiAgICAgICAgICAgICAgICAkYm9keS5jc3MoJ292ZXJmbG93JywgJ2hpZGRlbicpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCRib2R5LmhlaWdodCgpID4gJHdpbmRvdy5oZWlnaHQoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICRib2R5LmNzcygnbWFyZ2luLXJpZ2h0JywgYm9keW1hcmdpbnJpZ2h0ICsgc2Nyb2xsYmFyd2lkdGgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZihvcHRpb25zLmJhY2tncm91bmRhY3RpdmUpe1xyXG4gICAgICAgICAgICAgICAgLy9jYWxjdWxhdGVzIHRoZSB2ZXJ0aWNhbCBhbGlnblxyXG4gICAgICAgICAgICAgICAgJGVsLmNzcyh7XHJcbiAgICAgICAgICAgICAgICAgICAgdG9wOihcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHdpbmRvdy5oZWlnaHQoKSAtIChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRlbC5nZXQoMCkub2Zmc2V0SGVpZ2h0ICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcnNlSW50KCRlbC5jc3MoJ21hcmdpbi10b3AnKSwgMTApICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcnNlSW50KCRlbC5jc3MoJ21hcmdpbi1ib3R0b20nKSwgMTApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgICAgICAgICApLzIgKydweCdcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAkZWwuY3NzKHtcclxuICAgICAgICAgICAgICAgICd2aXNpYmlsaXR5JzogJ3Zpc2libGUnLFxyXG4gICAgICAgICAgICAgICAgJ29wYWNpdHknOiAxXHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgLy8gU2hvdyBiYWNrZ3JvdW5kXHJcbiAgICAgICAgICAgIGlmIChvcHRpb25zLmJhY2tncm91bmQpIHtcclxuICAgICAgICAgICAgICAgICRiYWNrZ3JvdW5kLmNzcyh7XHJcbiAgICAgICAgICAgICAgICAgICAgJ3Zpc2liaWxpdHknOiAndmlzaWJsZScsXHJcbiAgICAgICAgICAgICAgICAgICAgJ29wYWNpdHknOiBvcHRpb25zLm9wYWNpdHlcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIEZpeCBJRTggaXNzdWUgd2l0aCBiYWNrZ3JvdW5kIG5vdCBhcHBlYXJpbmdcclxuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJGJhY2tncm91bmQuY3NzKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJ29wYWNpdHknOiBvcHRpb25zLm9wYWNpdHlcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH0sIDApO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAkZWwuZGF0YSgncG9wdXAtdmlzaWJsZScsIHRydWUpO1xyXG5cclxuICAgICAgICAgICAgLy8gUG9zaXRpb24gcG9wdXBcclxuICAgICAgICAgICAgbWV0aG9kcy5yZXBvc2l0aW9uKGVsLCBvcmRpbmFsKTtcclxuXHJcbiAgICAgICAgICAgIC8vIFJlbWVtYmVyIHdoaWNoIGVsZW1lbnQgaGFkIGZvY3VzIGJlZm9yZSBvcGVuaW5nIGEgcG9wdXBcclxuICAgICAgICAgICAgJGVsLmRhdGEoJ2ZvY3VzZWRlbGVtZW50YmVmb3JlcG9wdXAnLCBkb2N1bWVudC5hY3RpdmVFbGVtZW50KTtcclxuXHJcbiAgICAgICAgICAgIC8vIEhhbmRsZXI6IEtlZXAgZm9jdXMgaW5zaWRlIGRpYWxvZyBib3hcclxuICAgICAgICAgICAgaWYgKG9wdGlvbnMua2VlcGZvY3VzKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBNYWtlIGhvbGRlciBkaXYgZm9jdXNhYmxlXHJcbiAgICAgICAgICAgICAgICAkZWwuYXR0cigndGFiaW5kZXgnLCAtMSk7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gRm9jdXMgcG9wdXAgb3IgdXNlciBzcGVjaWZpZWQgZWxlbWVudC5cclxuICAgICAgICAgICAgICAgIC8vIEluaXRpYWwgdGltZW91dCBvZiA1MG1zIGlzIHNldCB0byBnaXZlIHNvbWUgdGltZSB0byBwb3B1cCB0byBzaG93IGFmdGVyIGNsaWNraW5nIG9uXHJcbiAgICAgICAgICAgICAgICAvLyBgb3BlbmAgZWxlbWVudCwgYW5kIGFmdGVyIGFuaW1hdGlvbiBpcyBjb21wbGV0ZSB0byBwcmV2ZW50IGJhY2tncm91bmQgc2Nyb2xsaW5nLlxyXG4gICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAob3B0aW9ucy5mb2N1c2VsZW1lbnQgPT09ICdjbG9zZWJ1dHRvbicpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJCgnIycgKyBlbC5pZCArICcgLicgKyBlbC5pZCArIGNsb3Nlc3VmZml4ICsgJzpmaXJzdCcpLmZvY3VzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChvcHRpb25zLmZvY3VzZWxlbWVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkKG9wdGlvbnMuZm9jdXNlbGVtZW50KS5mb2N1cygpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRlbC5mb2N1cygpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0sIG9wdGlvbnMuZm9jdXNkZWxheSk7XHJcblxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBIaWRlIG1haW4gY29udGVudCBmcm9tIHNjcmVlbiByZWFkZXJzXHJcbiAgICAgICAgICAgICQob3B0aW9ucy5wYWdlY29udGFpbmVyKS5hdHRyKCdhcmlhLWhpZGRlbicsIHRydWUpO1xyXG5cclxuICAgICAgICAgICAgLy8gUmV2ZWFsIHBvcHVwIGNvbnRlbnQgdG8gc2NyZWVuIHJlYWRlcnNcclxuICAgICAgICAgICAgJGVsLmF0dHIoJ2FyaWEtaGlkZGVuJywgZmFsc2UpO1xyXG5cclxuICAgICAgICAgICAgY2FsbGJhY2soZWwsIG9yZGluYWwsIG9wdGlvbnMub25vcGVuKTtcclxuXHJcbiAgICAgICAgICAgIGlmICh0cmFuc2l0aW9uc3VwcG9ydCkge1xyXG4gICAgICAgICAgICAgICAgJHdyYXBwZXIub25lKCd0cmFuc2l0aW9uZW5kJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2soZWwsIG9yZGluYWwsIG9wdGlvbnMub3BlbnRyYW5zaXRpb25lbmQpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjYWxsYmFjayhlbCwgb3JkaW5hbCwgb3B0aW9ucy5vcGVudHJhbnNpdGlvbmVuZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBIaWRlIG1ldGhvZFxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHBhcmFtIG9iamVjdCBlbCAtIHBvcHVwIGluc3RhbmNlIERPTSBub2RlXHJcbiAgICAgICAgICogQHBhcmFtIGJvb2xlYW4gb3V0ZXJDbGljayAtIGNsaWNrIG9uIHRoZSBvdXRlciBjb250ZW50IGJlbG93IHBvcHVwXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgaGlkZTogZnVuY3Rpb24gKGVsLCBvdXRlckNsaWNrKSB7XHJcbiAgICAgICAgICAgIC8vIEdldCBpbmRleCBvZiBwb3B1cCBJRCBpbnNpZGUgb2YgdmlzaWJsZVBvcHVwc0FycmF5XHJcbiAgICAgICAgICAgIHZhciBwb3B1cElkSW5kZXggPSAkLmluQXJyYXkoZWwuaWQsIHZpc2libGVQb3B1cHNBcnJheSk7XHJcblxyXG4gICAgICAgICAgICAvLyBJZiBwb3B1cCBpcyBub3Qgb3BlbmVkLCBpZ25vcmUgdGhlIHJlc3Qgb2YgdGhlIGZ1bmN0aW9uXHJcbiAgICAgICAgICAgIGlmIChwb3B1cElkSW5kZXggPT09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmKG9wZW50aW1lcikgY2xlYXJUaW1lb3V0KG9wZW50aW1lcik7XHJcblxyXG4gICAgICAgICAgICB2YXIgJGJvZHkgPSAkKCdib2R5Jyk7XHJcbiAgICAgICAgICAgIHZhciAkZWwgPSAkKGVsKTtcclxuICAgICAgICAgICAgdmFyIG9wdGlvbnMgPSAkZWwuZGF0YSgncG9wdXBvcHRpb25zJyk7XHJcbiAgICAgICAgICAgIHZhciAkd3JhcHBlciA9ICQoJyMnICsgZWwuaWQgKyAnX3dyYXBwZXInKTtcclxuICAgICAgICAgICAgdmFyICRiYWNrZ3JvdW5kID0gJCgnIycgKyBlbC5pZCArICdfYmFja2dyb3VuZCcpO1xyXG5cclxuICAgICAgICAgICAgJGVsLmRhdGEoJ3BvcHVwLXZpc2libGUnLCBmYWxzZSk7XHJcblxyXG4gICAgICAgICAgICBpZiAodmlzaWJsZVBvcHVwc0FycmF5Lmxlbmd0aCA9PT0gMSkge1xyXG4gICAgICAgICAgICAgICAgJCgnaHRtbCcpLnJlbW92ZUNsYXNzKCdwb3B1cF92aXNpYmxlJykucmVtb3ZlQ2xhc3MoJ3BvcHVwX3Zpc2libGVfJyArIGVsLmlkKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGlmKCQoJ2h0bWwnKS5oYXNDbGFzcygncG9wdXBfdmlzaWJsZV8nICsgZWwuaWQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJCgnaHRtbCcpLnJlbW92ZUNsYXNzKCdwb3B1cF92aXNpYmxlXycgKyBlbC5pZCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIFJlbW92ZSBwb3B1cCBmcm9tIHRoZSB2aXNpYmxlUG9wdXBzQXJyYXlcclxuICAgICAgICAgICAgdmlzaWJsZVBvcHVwc0FycmF5LnNwbGljZShwb3B1cElkSW5kZXgsIDEpO1xyXG5cclxuICAgICAgICAgICAgaWYoJHdyYXBwZXIuaGFzQ2xhc3MoJ3BvcHVwX3dyYXBwZXJfdmlzaWJsZScpKSB7XHJcbiAgICAgICAgICAgICAgICAkd3JhcHBlci5yZW1vdmVDbGFzcygncG9wdXBfd3JhcHBlcl92aXNpYmxlJyk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIEZvY3VzIGJhY2sgb24gc2F2ZWQgZWxlbWVudFxyXG4gICAgICAgICAgICBpZiAob3B0aW9ucy5rZWVwZm9jdXMgJiYgIW91dGVyQ2xpY2spIHtcclxuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCQoJGVsLmRhdGEoJ2ZvY3VzZWRlbGVtZW50YmVmb3JlcG9wdXAnKSkuaXMoJzp2aXNpYmxlJykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJGVsLmRhdGEoJ2ZvY3VzZWRlbGVtZW50YmVmb3JlcG9wdXAnKS5mb2N1cygpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0sIDApO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBIaWRlIHBvcHVwXHJcbiAgICAgICAgICAgICR3cmFwcGVyLmNzcyh7XHJcbiAgICAgICAgICAgICAgICAndmlzaWJpbGl0eSc6ICdoaWRkZW4nLFxyXG4gICAgICAgICAgICAgICAgJ29wYWNpdHknOiAwXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAkZWwuY3NzKHtcclxuICAgICAgICAgICAgICAgICd2aXNpYmlsaXR5JzogJ2hpZGRlbicsXHJcbiAgICAgICAgICAgICAgICAnb3BhY2l0eSc6IDBcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyBIaWRlIGJhY2tncm91bmRcclxuICAgICAgICAgICAgaWYgKG9wdGlvbnMuYmFja2dyb3VuZCkge1xyXG4gICAgICAgICAgICAgICAgJGJhY2tncm91bmQuY3NzKHtcclxuICAgICAgICAgICAgICAgICAgICAndmlzaWJpbGl0eSc6ICdoaWRkZW4nLFxyXG4gICAgICAgICAgICAgICAgICAgICdvcGFjaXR5JzogMFxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIFJldmVhbCBtYWluIGNvbnRlbnQgdG8gc2NyZWVuIHJlYWRlcnNcclxuICAgICAgICAgICAgJChvcHRpb25zLnBhZ2Vjb250YWluZXIpLmF0dHIoJ2FyaWEtaGlkZGVuJywgZmFsc2UpO1xyXG5cclxuICAgICAgICAgICAgLy8gSGlkZSBwb3B1cCBjb250ZW50IGZyb20gc2NyZWVuIHJlYWRlcnNcclxuICAgICAgICAgICAgJGVsLmF0dHIoJ2FyaWEtaGlkZGVuJywgdHJ1ZSk7XHJcblxyXG4gICAgICAgICAgICAvLyBgb25jbG9zZWAgY2FsbGJhY2sgZXZlbnRcclxuICAgICAgICAgICAgY2FsbGJhY2soZWwsIGxhc3RjbGlja2VkW2VsLmlkXSwgb3B0aW9ucy5vbmNsb3NlKTtcclxuXHJcbiAgICAgICAgICAgIGlmICh0cmFuc2l0aW9uc3VwcG9ydCAmJiAkZWwuY3NzKCd0cmFuc2l0aW9uLWR1cmF0aW9uJykgIT09ICcwcycpIHtcclxuICAgICAgICAgICAgICAgICRlbC5vbmUoJ3RyYW5zaXRpb25lbmQnLCBmdW5jdGlvbihlKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghKCRlbC5kYXRhKCdwb3B1cC12aXNpYmxlJykpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvcHRpb25zLmRldGFjaCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJGVsLmhpZGUoKS5kZXRhY2goKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICR3cmFwcGVyLmhpZGUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gUmUtZW5hYmxlIHNjcm9sbGluZyBvZiBiYWNrZ3JvdW5kIGxheWVyXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wdGlvbnMuc2Nyb2xsbG9jaykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJGJvZHkuY3NzKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvdmVyZmxvdzogJ3Zpc2libGUnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdtYXJnaW4tcmlnaHQnOiBib2R5bWFyZ2lucmlnaHRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LCAxMCk7IC8vIDEwbXMgYWRkZWQgZm9yIENTUyB0cmFuc2l0aW9uIGluIEZpcmVmb3ggd2hpY2ggZG9lc24ndCBsaWtlIG92ZXJmbG93OmF1dG9cclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKGVsLCBsYXN0Y2xpY2tlZFtlbC5pZF0sIG9wdGlvbnMuY2xvc2V0cmFuc2l0aW9uZW5kKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaWYgKG9wdGlvbnMuZGV0YWNoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJGVsLmhpZGUoKS5kZXRhY2goKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHdyYXBwZXIuaGlkZSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIC8vIFJlLWVuYWJsZSBzY3JvbGxpbmcgb2YgYmFja2dyb3VuZCBsYXllclxyXG4gICAgICAgICAgICAgICAgaWYgKG9wdGlvbnMuc2Nyb2xsbG9jaykge1xyXG4gICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRib2R5LmNzcyh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvdmVyZmxvdzogJ3Zpc2libGUnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ21hcmdpbi1yaWdodCc6IGJvZHltYXJnaW5yaWdodFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9LCAxMCk7IC8vIDEwbXMgYWRkZWQgZm9yIENTUyB0cmFuc2l0aW9uIGluIEZpcmVmb3ggd2hpY2ggZG9lc24ndCBsaWtlIG92ZXJmbG93OmF1dG9cclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBjYWxsYmFjayhlbCwgbGFzdGNsaWNrZWRbZWwuaWRdLCBvcHRpb25zLmNsb3NldHJhbnNpdGlvbmVuZCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogVG9nZ2xlIG1ldGhvZFxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHBhcmFtIHtvYmplY3R9IGVsIC0gcG9wdXAgaW5zdGFuY2UgRE9NIG5vZGVcclxuICAgICAgICAgKiBAcGFyYW0ge251bWJlcn0gb3JkaW5hbCAtIG9yZGVyIG51bWJlciBvZiBhbiBgb3BlbmAgZWxlbWVudFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRvZ2dsZTogZnVuY3Rpb24gKGVsLCBvcmRpbmFsKSB7XHJcbiAgICAgICAgICAgIGlmICgkKGVsKS5kYXRhKCdwb3B1cC12aXNpYmxlJykpIHtcclxuICAgICAgICAgICAgICAgIG1ldGhvZHMuaGlkZShlbCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZHMuc2hvdyhlbCwgb3JkaW5hbCk7XHJcbiAgICAgICAgICAgICAgICB9LCAwKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFJlcG9zaXRpb24gbWV0aG9kXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcGFyYW0ge29iamVjdH0gZWwgLSBwb3B1cCBpbnN0YW5jZSBET00gbm9kZVxyXG4gICAgICAgICAqIEBwYXJhbSB7bnVtYmVyfSBvcmRpbmFsIC0gb3JkZXIgbnVtYmVyIG9mIGFuIGBvcGVuYCBlbGVtZW50XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgcmVwb3NpdGlvbjogZnVuY3Rpb24gKGVsLCBvcmRpbmFsKSB7XHJcbiAgICAgICAgICAgIHZhciAkZWwgPSAkKGVsKTtcclxuICAgICAgICAgICAgdmFyIG9wdGlvbnMgPSAkZWwuZGF0YSgncG9wdXBvcHRpb25zJyk7XHJcbiAgICAgICAgICAgIHZhciAkd3JhcHBlciA9ICQoJyMnICsgZWwuaWQgKyAnX3dyYXBwZXInKTtcclxuICAgICAgICAgICAgdmFyICRiYWNrZ3JvdW5kID0gJCgnIycgKyBlbC5pZCArICdfYmFja2dyb3VuZCcpO1xyXG5cclxuICAgICAgICAgICAgb3JkaW5hbCA9IG9yZGluYWwgfHwgMDtcclxuXHJcbiAgICAgICAgICAgIC8vIFRvb2x0aXAgdHlwZVxyXG4gICAgICAgICAgICBpZiAob3B0aW9ucy50eXBlID09ICd0b29sdGlwJykge1xyXG4gICAgICAgICAgICAgICAgJHdyYXBwZXIuY3NzKHtcclxuICAgICAgICAgICAgICAgICAgICAncG9zaXRpb24nOiAnYWJzb2x1dGUnXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgJHRvb2x0aXBhbmNob3I7XHJcbiAgICAgICAgICAgICAgICBpZiAob3B0aW9ucy50b29sdGlwYW5jaG9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHRvb2x0aXBhbmNob3IgPSAkKG9wdGlvbnMudG9vbHRpcGFuY2hvcik7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG9wdGlvbnMub3BlbmVsZW1lbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICAkdG9vbHRpcGFuY2hvciA9ICQob3B0aW9ucy5vcGVuZWxlbWVudCkuZmlsdGVyKCdbZGF0YS1wb3B1cC1vcmRpbmFsPVwiJyArIG9yZGluYWwgKyAnXCJdJyk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICR0b29sdGlwYW5jaG9yID0gJCgnLicgKyBlbC5pZCArIG9wZW5zdWZmaXggKyAnW2RhdGEtcG9wdXAtb3JkaW5hbD1cIicgKyBvcmRpbmFsICsgJ1wiXScpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHZhciBsaW5rT2Zmc2V0ID0gJHRvb2x0aXBhbmNob3Iub2Zmc2V0KCk7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gSG9yaXpvbnRhbCBwb3NpdGlvbiBmb3IgdG9vbHRpcFxyXG4gICAgICAgICAgICAgICAgaWYgKG9wdGlvbnMuaG9yaXpvbnRhbCA9PSAncmlnaHQnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHdyYXBwZXIuY3NzKCdsZWZ0JywgbGlua09mZnNldC5sZWZ0ICsgJHRvb2x0aXBhbmNob3Iub3V0ZXJXaWR0aCgpICsgb3B0aW9ucy5vZmZzZXRsZWZ0KTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAob3B0aW9ucy5ob3Jpem9udGFsID09ICdsZWZ0ZWRnZScpIHtcclxuICAgICAgICAgICAgICAgICAgICAkd3JhcHBlci5jc3MoJ2xlZnQnLCBsaW5rT2Zmc2V0LmxlZnQgKyAkdG9vbHRpcGFuY2hvci5vdXRlcldpZHRoKCkgLSAkdG9vbHRpcGFuY2hvci5vdXRlcldpZHRoKCkgKyAgb3B0aW9ucy5vZmZzZXRsZWZ0KTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAob3B0aW9ucy5ob3Jpem9udGFsID09ICdsZWZ0Jykge1xyXG4gICAgICAgICAgICAgICAgICAgICR3cmFwcGVyLmNzcygncmlnaHQnLCAkd2luZG93LndpZHRoKCkgLSBsaW5rT2Zmc2V0LmxlZnQgIC0gb3B0aW9ucy5vZmZzZXRsZWZ0KTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAob3B0aW9ucy5ob3Jpem9udGFsID09ICdyaWdodGVkZ2UnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHdyYXBwZXIuY3NzKCdyaWdodCcsICR3aW5kb3cud2lkdGgoKSAgLSBsaW5rT2Zmc2V0LmxlZnQgLSAkdG9vbHRpcGFuY2hvci5vdXRlcldpZHRoKCkgLSBvcHRpb25zLm9mZnNldGxlZnQpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAkd3JhcHBlci5jc3MoJ2xlZnQnLCBsaW5rT2Zmc2V0LmxlZnQgKyAoJHRvb2x0aXBhbmNob3Iub3V0ZXJXaWR0aCgpIC8gMikgLSAoJGVsLm91dGVyV2lkdGgoKSAvIDIpIC0gcGFyc2VGbG9hdCgkZWwuY3NzKCdtYXJnaW5MZWZ0JykpICsgb3B0aW9ucy5vZmZzZXRsZWZ0KTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAvLyBWZXJ0aWNhbCBwb3NpdGlvbiBmb3IgdG9vbHRpcFxyXG4gICAgICAgICAgICAgICAgaWYgKG9wdGlvbnMudmVydGljYWwgPT0gJ2JvdHRvbScpIHtcclxuICAgICAgICAgICAgICAgICAgICAkd3JhcHBlci5jc3MoJ3RvcCcsIGxpbmtPZmZzZXQudG9wICsgJHRvb2x0aXBhbmNob3Iub3V0ZXJIZWlnaHQoKSArIG9wdGlvbnMub2Zmc2V0dG9wKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAob3B0aW9ucy52ZXJ0aWNhbCA9PSAnYm90dG9tZWRnZScpIHtcclxuICAgICAgICAgICAgICAgICAgICAkd3JhcHBlci5jc3MoJ3RvcCcsIGxpbmtPZmZzZXQudG9wICsgJHRvb2x0aXBhbmNob3Iub3V0ZXJIZWlnaHQoKSAtICRlbC5vdXRlckhlaWdodCgpICsgb3B0aW9ucy5vZmZzZXR0b3ApO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChvcHRpb25zLnZlcnRpY2FsID09ICd0b3AnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHdyYXBwZXIuY3NzKCdib3R0b20nLCAkd2luZG93LmhlaWdodCgpIC0gbGlua09mZnNldC50b3AgLSBvcHRpb25zLm9mZnNldHRvcCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG9wdGlvbnMudmVydGljYWwgPT0gJ3RvcGVkZ2UnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHdyYXBwZXIuY3NzKCdib3R0b20nLCAkd2luZG93LmhlaWdodCgpIC0gbGlua09mZnNldC50b3AgLSAkZWwub3V0ZXJIZWlnaHQoKSAtIG9wdGlvbnMub2Zmc2V0dG9wKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHdyYXBwZXIuY3NzKCd0b3AnLCBsaW5rT2Zmc2V0LnRvcCArICgkdG9vbHRpcGFuY2hvci5vdXRlckhlaWdodCgpIC8gMikgLSAoJGVsLm91dGVySGVpZ2h0KCkgLyAyKSAtIHBhcnNlRmxvYXQoJGVsLmNzcygnbWFyZ2luVG9wJykpICsgb3B0aW9ucy5vZmZzZXR0b3ApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gT3ZlcmxheSB0eXBlXHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAob3B0aW9ucy50eXBlID09ICdvdmVybGF5Jykge1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIEhvcml6b250YWwgcG9zaXRpb24gZm9yIG92ZXJsYXlcclxuICAgICAgICAgICAgICAgIGlmIChvcHRpb25zLmhvcml6b250YWwpIHtcclxuICAgICAgICAgICAgICAgICAgICAkd3JhcHBlci5jc3MoJ3RleHQtYWxpZ24nLCBvcHRpb25zLmhvcml6b250YWwpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAkd3JhcHBlci5jc3MoJ3RleHQtYWxpZ24nLCAnY2VudGVyJyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gVmVydGljYWwgcG9zaXRpb24gZm9yIG92ZXJsYXlcclxuICAgICAgICAgICAgICAgIGlmIChvcHRpb25zLnZlcnRpY2FsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJGVsLmNzcygndmVydGljYWwtYWxpZ24nLCBvcHRpb25zLnZlcnRpY2FsKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJGVsLmNzcygndmVydGljYWwtYWxpZ24nLCAnbWlkZGxlJyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBBZGQtY2xvc2UtYnV0dG9uIG1ldGhvZFxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHBhcmFtIHtvYmplY3R9IGVsIC0gcG9wdXAgaW5zdGFuY2UgRE9NIG5vZGVcclxuICAgICAgICAgKi9cclxuICAgICAgICBhZGRjbG9zZWJ1dHRvbjogZnVuY3Rpb24gKGVsKSB7XHJcbiAgICAgICAgICAgIHZhciBnZW5lcmljQ2xvc2VCdXR0b247XHJcblxyXG4gICAgICAgICAgICBpZiAoJChlbCkuZGF0YSgncG9wdXBvcHRpb25zJykuY2xvc2VidXR0b25tYXJrdXApIHtcclxuICAgICAgICAgICAgICAgIGdlbmVyaWNDbG9zZUJ1dHRvbiA9ICQob3B0aW9ucy5jbG9zZWJ1dHRvbm1hcmt1cCkuYWRkQ2xhc3MoZWwuaWQgKyAnX2Nsb3NlJyk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBnZW5lcmljQ2xvc2VCdXR0b24gPSAnPGJ1dHRvbiBjbGFzcz1cInBvcHVwX2Nsb3NlICcgKyBlbC5pZCArICdfY2xvc2VcIiB0aXRsZT1cIkNsb3NlXCIgYXJpYS1sYWJlbD1cIkNsb3NlXCI+PHNwYW4gYXJpYS1oaWRkZW49XCJ0cnVlXCI+w5c8L3NwYW4+PC9idXR0b24+JztcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKCRlbC5kYXRhKCdwb3B1cC1pbml0aWFsaXplZCcpKXtcclxuICAgICAgICAgICAgICAgICRlbC5hcHBlbmQoZ2VuZXJpY0Nsb3NlQnV0dG9uKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIENhbGxiYWNrIGV2ZW50IGNhbGxzXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtvYmplY3R9IGVsIC0gcG9wdXAgaW5zdGFuY2UgRE9NIG5vZGVcclxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBvcmRpbmFsIC0gb3JkZXIgbnVtYmVyIG9mIGFuIGBvcGVuYCBlbGVtZW50XHJcbiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9ufSBmdW5jIC0gY2FsbGJhY2sgZnVuY3Rpb25cclxuICAgICAqL1xyXG4gICAgdmFyIGNhbGxiYWNrID0gZnVuY3Rpb24gKGVsLCBvcmRpbmFsLCBmdW5jKSB7XHJcbiAgICAgICAgdmFyIG9wdGlvbnMgPSAkKGVsKS5kYXRhKCdwb3B1cG9wdGlvbnMnKTtcclxuICAgICAgICB2YXIgb3BlbmVsZW1lbnQgPSAgKG9wdGlvbnMub3BlbmVsZW1lbnQpID8gb3B0aW9ucy5vcGVuZWxlbWVudCA6ICgnLicgKyBlbC5pZCArIG9wZW5zdWZmaXgpO1xyXG4gICAgICAgIHZhciBlbGVtZW50Y2xpY2tlZCA9ICQob3BlbmVsZW1lbnQgKyAnW2RhdGEtcG9wdXAtb3JkaW5hbD1cIicgKyBvcmRpbmFsICsgJ1wiXScpO1xyXG4gICAgICAgIGlmICh0eXBlb2YgZnVuYyA9PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgICAgIGZ1bmMuY2FsbCgkKGVsKSwgZWwsIGVsZW1lbnRjbGlja2VkKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIC8vIEhpZGUgcG9wdXAgaWYgRVNDIGtleSBpcyBwcmVzc2VkXHJcbiAgICAkKGRvY3VtZW50KS5vbigna2V5ZG93bicsIGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgIGlmKHZpc2libGVQb3B1cHNBcnJheS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgdmFyIGVsZW1lbnRJZCA9IHZpc2libGVQb3B1cHNBcnJheVt2aXNpYmxlUG9wdXBzQXJyYXkubGVuZ3RoIC0gMV07XHJcbiAgICAgICAgICAgIHZhciBlbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGVsZW1lbnRJZCk7XHJcblxyXG4gICAgICAgICAgICBpZiAoJChlbCkuZGF0YSgncG9wdXBvcHRpb25zJykuZXNjYXBlICYmIGV2ZW50LmtleUNvZGUgPT0gMjcpIHtcclxuICAgICAgICAgICAgICAgIG1ldGhvZHMuaGlkZShlbCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBIaWRlIHBvcHVwIG9uIGNsaWNrXHJcbiAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICBpZih2aXNpYmxlUG9wdXBzQXJyYXkubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHZhciBlbGVtZW50SWQgPSB2aXNpYmxlUG9wdXBzQXJyYXlbdmlzaWJsZVBvcHVwc0FycmF5Lmxlbmd0aCAtIDFdO1xyXG4gICAgICAgICAgICB2YXIgZWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChlbGVtZW50SWQpO1xyXG4gICAgICAgICAgICB2YXIgY2xvc2VCdXR0b24gPSAoJChlbCkuZGF0YSgncG9wdXBvcHRpb25zJykuY2xvc2VlbGVtZW50KSA/ICQoZWwpLmRhdGEoJ3BvcHVwb3B0aW9ucycpLmNsb3NlZWxlbWVudCA6ICgnLicgKyBlbC5pZCArIGNsb3Nlc3VmZml4KTtcclxuXHJcbiAgICAgICAgICAgIC8vIElmIENsb3NlIGJ1dHRvbiBjbGlja2VkXHJcbiAgICAgICAgICAgIGlmICgkKGV2ZW50LnRhcmdldCkuY2xvc2VzdChjbG9zZUJ1dHRvbikubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgbWV0aG9kcy5oaWRlKGVsKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gSWYgY2xpY2tlZCBvdXRzaWRlIG9mIHBvcHVwXHJcbiAgICAgICAgICAgIGlmICgkKGVsKS5kYXRhKCdwb3B1cG9wdGlvbnMnKS5ibHVyICYmICEkKGV2ZW50LnRhcmdldCkuY2xvc2VzdCgnIycgKyBlbGVtZW50SWQpLmxlbmd0aCAmJiBldmVudC53aGljaCAhPT0gMiAmJiAkKGV2ZW50LnRhcmdldCkuaXMoJzp2aXNpYmxlJykpIHtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoJChlbCkuZGF0YSgncG9wdXBvcHRpb25zJykuYmFja2dyb3VuZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIElmIGNsaWNrZWQgb24gcG9wdXAgY292ZXJcclxuICAgICAgICAgICAgICAgICAgICBtZXRob2RzLmhpZGUoZWwpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAvLyBPbGRlciBpT1MvU2FmYXJpIHdpbGwgdHJpZ2dlciBhIGNsaWNrIG9uIHRoZSBlbGVtZW50cyBiZWxvdyB0aGUgY292ZXIsXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gd2hlbiB0YXBwaW5nIG9uIHRoZSBjb3Zlciwgc28gdGhlIGRlZmF1bHQgYWN0aW9uIG5lZWRzIHRvIGJlIHByZXZlbnRlZC5cclxuICAgICAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gSWYgY2xpY2tlZCBvbiBvdXRlciBjb250ZW50XHJcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kcy5oaWRlKGVsLCB0cnVlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIC8vIEtlZXAga2V5Ym9hcmQgZm9jdXMgaW5zaWRlIG9mIHBvcHVwXHJcbiAgICAkKGRvY3VtZW50KS5vbigna2V5ZG93bicsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgaWYodmlzaWJsZVBvcHVwc0FycmF5Lmxlbmd0aCAmJiBldmVudC53aGljaCA9PSA5KSB7XHJcblxyXG4gICAgICAgICAgICAvLyBJZiB0YWIgb3Igc2hpZnQtdGFiIHByZXNzZWRcclxuICAgICAgICAgICAgdmFyIGVsZW1lbnRJZCA9IHZpc2libGVQb3B1cHNBcnJheVt2aXNpYmxlUG9wdXBzQXJyYXkubGVuZ3RoIC0gMV07XHJcbiAgICAgICAgICAgIHZhciBlbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGVsZW1lbnRJZCk7XHJcblxyXG4gICAgICAgICAgICAvLyBHZXQgbGlzdCBvZiBhbGwgY2hpbGRyZW4gZWxlbWVudHMgaW4gZ2l2ZW4gb2JqZWN0XHJcbiAgICAgICAgICAgIHZhciBwb3B1cEl0ZW1zID0gJChlbCkuZmluZCgnKicpO1xyXG5cclxuICAgICAgICAgICAgLy8gR2V0IGxpc3Qgb2YgZm9jdXNhYmxlIGl0ZW1zXHJcbiAgICAgICAgICAgIHZhciBmb2N1c2FibGVJdGVtcyA9IHBvcHVwSXRlbXMuZmlsdGVyKGZvY3VzYWJsZUVsZW1lbnRzU3RyaW5nKS5maWx0ZXIoJzp2aXNpYmxlJyk7XHJcblxyXG4gICAgICAgICAgICAvLyBHZXQgY3VycmVudGx5IGZvY3VzZWQgaXRlbVxyXG4gICAgICAgICAgICB2YXIgZm9jdXNlZEl0ZW0gPSAkKCc6Zm9jdXMnKTtcclxuXHJcbiAgICAgICAgICAgIC8vIEdldCB0aGUgbnVtYmVyIG9mIGZvY3VzYWJsZSBpdGVtc1xyXG4gICAgICAgICAgICB2YXIgbnVtYmVyT2ZGb2N1c2FibGVJdGVtcyA9IGZvY3VzYWJsZUl0ZW1zLmxlbmd0aDtcclxuXHJcbiAgICAgICAgICAgIC8vIEdldCB0aGUgaW5kZXggb2YgdGhlIGN1cnJlbnRseSBmb2N1c2VkIGl0ZW1cclxuICAgICAgICAgICAgdmFyIGZvY3VzZWRJdGVtSW5kZXggPSBmb2N1c2FibGVJdGVtcy5pbmRleChmb2N1c2VkSXRlbSk7XHJcblxyXG4gICAgICAgICAgICAvLyBJZiBwb3B1cCBkb2Vzbid0IGNvbnRhaW4gZm9jdXNhYmxlIGVsZW1lbnRzLCBmb2N1cyBwb3B1cCBpdHNlbGZcclxuICAgICAgICAgICAgaWYgKG51bWJlck9mRm9jdXNhYmxlSXRlbXMgPT09IDApIHtcclxuICAgICAgICAgICAgICAgICQoZWwpLmZvY3VzKCk7XHJcbiAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaWYgKGV2ZW50LnNoaWZ0S2V5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gQmFjayB0YWJcclxuICAgICAgICAgICAgICAgICAgICAvLyBJZiBmb2N1c2VkIG9uIGZpcnN0IGl0ZW0gYW5kIHVzZXIgcHJlc2VzIGJhY2stdGFiLCBnbyB0byB0aGUgbGFzdCBmb2N1c2FibGUgaXRlbVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChmb2N1c2VkSXRlbUluZGV4ID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvY3VzYWJsZUl0ZW1zLmdldChudW1iZXJPZkZvY3VzYWJsZUl0ZW1zIC0gMSkuZm9jdXMoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBGb3J3YXJkIHRhYlxyXG4gICAgICAgICAgICAgICAgICAgIC8vIElmIGZvY3VzZWQgb24gdGhlIGxhc3QgaXRlbSBhbmQgdXNlciBwcmVzZXMgdGFiLCBnbyB0byB0aGUgZmlyc3QgZm9jdXNhYmxlIGl0ZW1cclxuICAgICAgICAgICAgICAgICAgICBpZiAoZm9jdXNlZEl0ZW1JbmRleCA9PSBudW1iZXJPZkZvY3VzYWJsZUl0ZW1zIC0gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb2N1c2FibGVJdGVtcy5nZXQoMCkuZm9jdXMoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIFBsdWdpbiBBUElcclxuICAgICAqL1xyXG4gICAgJC5mbi5wb3B1cCA9IGZ1bmN0aW9uIChjdXN0b21vcHRpb25zKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgICAgICB2YXIgJGVsID0gJCh0aGlzKTtcclxuXHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgY3VzdG9tb3B0aW9ucyA9PT0gJ29iamVjdCcpIHsgIC8vIGUuZy4gJCgnI3BvcHVwJykucG9wdXAoeydjb2xvcic6J2JsdWUnfSlcclxuICAgICAgICAgICAgICAgIHZhciBvcHQgPSAkLmV4dGVuZCh7fSwgJC5mbi5wb3B1cC5kZWZhdWx0cywgY3VzdG9tb3B0aW9ucywgJGVsLmRhdGEoJ3BvcHVwb3B0aW9ucycpKTtcclxuICAgICAgICAgICAgICAgICRlbC5kYXRhKCdwb3B1cG9wdGlvbnMnLCBvcHQpO1xyXG4gICAgICAgICAgICAgICAgb3B0aW9ucyA9ICRlbC5kYXRhKCdwb3B1cG9wdGlvbnMnKTtcclxuXHJcbiAgICAgICAgICAgICAgICBtZXRob2RzLl9pbml0KHRoaXMpO1xyXG5cclxuICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgY3VzdG9tb3B0aW9ucyA9PT0gJ3N0cmluZycpIHsgLy8gZS5nLiAkKCcjcG9wdXAnKS5wb3B1cCgnaGlkZScpXHJcbiAgICAgICAgICAgICAgICBpZiAoISgkZWwuZGF0YSgncG9wdXBvcHRpb25zJykpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJGVsLmRhdGEoJ3BvcHVwb3B0aW9ucycsICQuZm4ucG9wdXAuZGVmYXVsdHMpO1xyXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnMgPSAkZWwuZGF0YSgncG9wdXBvcHRpb25zJyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgbWV0aG9kc1tjdXN0b21vcHRpb25zXS5jYWxsKHRoaXMsIHRoaXMpO1xyXG5cclxuICAgICAgICAgICAgfSBlbHNlIHsgLy8gZS5nLiAkKCcjcG9wdXAnKS5wb3B1cCgpXHJcbiAgICAgICAgICAgICAgICBpZiAoISgkZWwuZGF0YSgncG9wdXBvcHRpb25zJykpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJGVsLmRhdGEoJ3BvcHVwb3B0aW9ucycsICQuZm4ucG9wdXAuZGVmYXVsdHMpO1xyXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnMgPSAkZWwuZGF0YSgncG9wdXBvcHRpb25zJyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgbWV0aG9kcy5faW5pdCh0aGlzKTtcclxuXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG5cclxuICAgICQuZm4ucG9wdXAuZGVmYXVsdHMgPSB7XHJcbiAgICAgICAgdHlwZTogJ292ZXJsYXknLFxyXG4gICAgICAgIGF1dG9vcGVuOiBmYWxzZSxcclxuICAgICAgICBiYWNrZ3JvdW5kOiB0cnVlLFxyXG4gICAgICAgIGJhY2tncm91bmRhY3RpdmU6IGZhbHNlLFxyXG4gICAgICAgIGNvbG9yOiAnYmxhY2snLFxyXG4gICAgICAgIG9wYWNpdHk6ICcwLjUnLFxyXG4gICAgICAgIGhvcml6b250YWw6ICdjZW50ZXInLFxyXG4gICAgICAgIHZlcnRpY2FsOiAnbWlkZGxlJyxcclxuICAgICAgICBvZmZzZXR0b3A6IDAsXHJcbiAgICAgICAgb2Zmc2V0bGVmdDogMCxcclxuICAgICAgICBlc2NhcGU6IHRydWUsXHJcbiAgICAgICAgYmx1cjogdHJ1ZSxcclxuICAgICAgICBzZXR6aW5kZXg6IHRydWUsXHJcbiAgICAgICAgYXV0b3ppbmRleDogZmFsc2UsXHJcbiAgICAgICAgc2Nyb2xsbG9jazogZmFsc2UsXHJcbiAgICAgICAgY2xvc2VidXR0b246IGZhbHNlLFxyXG4gICAgICAgIGNsb3NlYnV0dG9ubWFya3VwOiBudWxsLFxyXG4gICAgICAgIGtlZXBmb2N1czogdHJ1ZSxcclxuICAgICAgICBmb2N1c2VsZW1lbnQ6IG51bGwsXHJcbiAgICAgICAgZm9jdXNkZWxheTogNTAsXHJcbiAgICAgICAgb3V0bGluZTogZmFsc2UsXHJcbiAgICAgICAgcGFnZWNvbnRhaW5lcjogbnVsbCxcclxuICAgICAgICBkZXRhY2g6IGZhbHNlLFxyXG4gICAgICAgIG9wZW5lbGVtZW50OiBudWxsLFxyXG4gICAgICAgIGNsb3NlZWxlbWVudDogbnVsbCxcclxuICAgICAgICB0cmFuc2l0aW9uOiBudWxsLFxyXG4gICAgICAgIHRvb2x0aXBhbmNob3I6IG51bGwsXHJcbiAgICAgICAgYmVmb3Jlb3BlbjogbnVsbCxcclxuICAgICAgICBvbmNsb3NlOiBudWxsLFxyXG4gICAgICAgIG9ub3BlbjogbnVsbCxcclxuICAgICAgICBvcGVudHJhbnNpdGlvbmVuZDogbnVsbCxcclxuICAgICAgICBjbG9zZXRyYW5zaXRpb25lbmQ6IG51bGxcclxuICAgIH07XHJcblxyXG59KShqUXVlcnkpO1xyXG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
